{"ast":null,"code":"var _s = $RefreshSig$();\nimport api from '../utils/api';\nimport useFlashMessage from './useFlashMessage';\nimport { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nexport default function useAuth() {\n  _s();\n  const [autenticado, setAutenticado] = useState(false);\n  const {\n    setFlashMessage\n  } = useFlashMessage();\n  const navigate = useNavigate();\n\n  // Inserir o token automaticamente quando o usuário acessar a página\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n\n    // Se tiver token ira colocar no headers authorization automaticamente\n    if (token) {\n      api.defaults.headers.Authorization = `Bearer ${JSON.parse(token)}`;\n      setAutenticado(true);\n    }\n  }, []);\n  async function register(usuario) {\n    let msg = 'Cadastro realizado comusuario sucesso!';\n    let type = 'sucess';\n    try {\n      const data = await api.post('/usuarios/registrar', usuario).then(response => {\n        return response.data;\n      });\n      // Executa a função de autenticar\n      await authUser(data);\n    } catch (error) {\n      msg = error.response.data.message;\n      type = 'error';\n    }\n    setFlashMessage(msg, type);\n  }\n\n  // Vai receber os dados do login\n  async function authUser(data) {\n    setAutenticado(true);\n\n    // Salva token no local storage\n    localStorage.setItem('token', JSON.stringify(data.token));\n\n    // Após usuário logado ira ser mandado para a home\n    navigate('/');\n  }\n\n  // Vai logar os usuários\n  async function loginUser() {}\n\n  // Vai deslogar os usuários\n  async function logoutUser() {\n    const msgText = 'Usuário deslogado';\n    const msgType = 'sucess';\n    setAutenticado(false);\n\n    // Remover o token\n    localStorage.removeItem('token');\n\n    // Remover token do headers authorization\n    api.defaults.headers.Authorization = undefined;\n\n    // Após usuário deslogado ira ser mandado para o login\n    navigate('/login');\n    setFlashMessage(msgText, msgType);\n  }\n  return {\n    autenticado,\n    register,\n    logoutUser\n  };\n}\n_s(useAuth, \"9lifsgrvUj8ytB0rGNFwiBBLjaE=\", false, function () {\n  return [useFlashMessage, useNavigate];\n});","map":{"version":3,"names":["api","useFlashMessage","useState","useEffect","useNavigate","useAuth","_s","autenticado","setAutenticado","setFlashMessage","navigate","token","localStorage","getItem","defaults","headers","Authorization","JSON","parse","register","usuario","msg","type","data","post","then","response","authUser","error","message","setItem","stringify","loginUser","logoutUser","msgText","msgType","removeItem","undefined"],"sources":["/home/kaue/Downloads/Node/mongo/frontend/src/hooks/useAuth.js"],"sourcesContent":["import api from '../utils/api'\nimport useFlashMessage from './useFlashMessage'\n\nimport {useState, useEffect} from 'react'\nimport { useNavigate } from 'react-router-dom';\n\n\nexport default function useAuth(){\n    const [autenticado, setAutenticado] = useState(false)\n    const {setFlashMessage} = useFlashMessage()\n    const navigate = useNavigate()\n\n    // Inserir o token automaticamente quando o usuário acessar a página\n    useEffect(() => {\n\n        const token = localStorage.getItem('token')\n\n        // Se tiver token ira colocar no headers authorization automaticamente\n        if(token){\n            api.defaults.headers.Authorization = `Bearer ${JSON.parse(token)}`\n            setAutenticado(true)\n        }\n\n    },[])\n\n    async function register(usuario){\n\n        let msg = 'Cadastro realizado comusuario sucesso!'\n        let type = 'sucess'\n    \n        try {\n            const data = await api.post('/usuarios/registrar', usuario).then((response) => {\n                return response.data\n            })\n            // Executa a função de autenticar\n            await authUser(data)\n        } catch (error) {\n            msg = error.response.data.message\n            type = 'error'\n        }\n\n        setFlashMessage(msg, type)\n    }\n\n    // Vai receber os dados do login\n    async function authUser(data){\n        setAutenticado(true)\n\n        // Salva token no local storage\n        localStorage.setItem('token', JSON.stringify(data.token))\n\n        // Após usuário logado ira ser mandado para a home\n        navigate('/')\n    }\n\n    // Vai logar os usuários\n    async function loginUser(){}\n\n    // Vai deslogar os usuários\n    async function logoutUser(){\n        const msgText = 'Usuário deslogado'\n        const msgType = 'sucess'\n\n        setAutenticado(false)\n\n        // Remover o token\n        localStorage.removeItem('token')\n\n        // Remover token do headers authorization\n        api.defaults.headers.Authorization = undefined\n\n        // Após usuário deslogado ira ser mandado para o login\n        navigate('/login')\n\n        setFlashMessage(msgText, msgType)\n    }\n\n    return {autenticado, register, logoutUser}\n}\n\n"],"mappings":";AAAA,OAAOA,GAAG,MAAM,cAAc;AAC9B,OAAOC,eAAe,MAAM,mBAAmB;AAE/C,SAAQC,QAAQ,EAAEC,SAAS,QAAO,OAAO;AACzC,SAASC,WAAW,QAAQ,kBAAkB;AAG9C,eAAe,SAASC,OAAOA,CAAA,EAAE;EAAAC,EAAA;EAC7B,MAAM,CAACC,WAAW,EAAEC,cAAc,CAAC,GAAGN,QAAQ,CAAC,KAAK,CAAC;EACrD,MAAM;IAACO;EAAe,CAAC,GAAGR,eAAe,EAAE;EAC3C,MAAMS,QAAQ,GAAGN,WAAW,EAAE;;EAE9B;EACAD,SAAS,CAAC,MAAM;IAEZ,MAAMQ,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;;IAE3C;IACA,IAAGF,KAAK,EAAC;MACLX,GAAG,CAACc,QAAQ,CAACC,OAAO,CAACC,aAAa,GAAI,UAASC,IAAI,CAACC,KAAK,CAACP,KAAK,CAAE,EAAC;MAClEH,cAAc,CAAC,IAAI,CAAC;IACxB;EAEJ,CAAC,EAAC,EAAE,CAAC;EAEL,eAAeW,QAAQA,CAACC,OAAO,EAAC;IAE5B,IAAIC,GAAG,GAAG,wCAAwC;IAClD,IAAIC,IAAI,GAAG,QAAQ;IAEnB,IAAI;MACA,MAAMC,IAAI,GAAG,MAAMvB,GAAG,CAACwB,IAAI,CAAC,qBAAqB,EAAEJ,OAAO,CAAC,CAACK,IAAI,CAAEC,QAAQ,IAAK;QAC3E,OAAOA,QAAQ,CAACH,IAAI;MACxB,CAAC,CAAC;MACF;MACA,MAAMI,QAAQ,CAACJ,IAAI,CAAC;IACxB,CAAC,CAAC,OAAOK,KAAK,EAAE;MACZP,GAAG,GAAGO,KAAK,CAACF,QAAQ,CAACH,IAAI,CAACM,OAAO;MACjCP,IAAI,GAAG,OAAO;IAClB;IAEAb,eAAe,CAACY,GAAG,EAAEC,IAAI,CAAC;EAC9B;;EAEA;EACA,eAAeK,QAAQA,CAACJ,IAAI,EAAC;IACzBf,cAAc,CAAC,IAAI,CAAC;;IAEpB;IACAI,YAAY,CAACkB,OAAO,CAAC,OAAO,EAAEb,IAAI,CAACc,SAAS,CAACR,IAAI,CAACZ,KAAK,CAAC,CAAC;;IAEzD;IACAD,QAAQ,CAAC,GAAG,CAAC;EACjB;;EAEA;EACA,eAAesB,SAASA,CAAA,EAAE,CAAC;;EAE3B;EACA,eAAeC,UAAUA,CAAA,EAAE;IACvB,MAAMC,OAAO,GAAG,mBAAmB;IACnC,MAAMC,OAAO,GAAG,QAAQ;IAExB3B,cAAc,CAAC,KAAK,CAAC;;IAErB;IACAI,YAAY,CAACwB,UAAU,CAAC,OAAO,CAAC;;IAEhC;IACApC,GAAG,CAACc,QAAQ,CAACC,OAAO,CAACC,aAAa,GAAGqB,SAAS;;IAE9C;IACA3B,QAAQ,CAAC,QAAQ,CAAC;IAElBD,eAAe,CAACyB,OAAO,EAAEC,OAAO,CAAC;EACrC;EAEA,OAAO;IAAC5B,WAAW;IAAEY,QAAQ;IAAEc;EAAU,CAAC;AAC9C;AAAC3B,EAAA,CAvEuBD,OAAO;EAAA,QAEDJ,eAAe,EACxBG,WAAW;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}